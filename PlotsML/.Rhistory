Ord_Gut_BPI_Oswestry_RMDQ_SF = read.csv('indata/Ordinal_Gut_BPI_Oswestry_RMDQ_SF.csv', sep = ',')
Ord_Gut_BPI_Oswestry_RMDQ_SF[1] = NULL
#Binárias e ordinais até o momento
Binaria_Ordinal_Q1_Q2_Q3_Q4_Q5_Q6 = data.frame(cbind(Bin_Gut_BPI_RMDQ_DN,Ord_Gut_BPI_Oswestry_RMDQ_SF))
# Subset com as variáveis ordinais ----------------------------------------
ordinallist = names(Ord_Gut_BPI_Oswestry_RMDQ_SF)
ordinaldf = Ord_Gut_BPI_Oswestry_RMDQ_SF
# Variáveis Binárias ----------------------------------------
bindata = Bin_Gut_BPI_RMDQ_DN #(Oswestry e SF não tem binária)
#N?o há relação de ordinalidade, logo, todos os dados do dataset bindata são
#Se N?o adicionarmos [], R N?o mantém a estrutura de fatores
bindata[] = lapply(bindata[], factor)
#Primeira coluna é ind??ce, logo, podemos deletar
bindata[1] = NULL
dfbind = cbind(ordinaldf,bindata)
#write.csv(dfbind,'binaria_e_ordinal.csv')
library(reshape2)
meltdata = melt(data = dfbind, id.vars = names(bindata), measure.vars = names(ordinaldf))
names(meltdata)
write.csv(meltdata, 'outputdata/meltdataboxsplot.csv')
#Dor na lombar
ggplot(data = meltdata, aes(D30,value)) +
geom_boxplot(aes(fill = D30)) +
geom_jitter(size = 0.5) +
facet_wrap(.~variable, scales = "free")
library(polycor)
var1 = as.numeric(dfbind$Ord_RMDQ)
var2 = as.numeric(dfbind$D35)
a = polyserial(var1,var2)
test = cor.test(var1, var2)
# Matriz de correlação  ---------------------------------------------------
rpb = matrix(NA, nrow = length(ordinaldf)*length(bindata), ncol = 1)
xaxis = matrix(NA, nrow = length(ordinaldf)*length(bindata), ncol = 1)
yaxis = matrix(NA, nrow = length(ordinaldf)*length(bindata), ncol = 1)
cont_Bin_0 = matrix(NA, nrow = length(ordinaldf)*length(bindata), ncol = 1)
cont_Bin_1 = matrix(NA, nrow = length(ordinaldf)*length(bindata), ncol = 1)
missing = matrix(NA, nrow = length(ordinaldf)*length(bindata), ncol = 1)
pvalue = matrix(NA, nrow = length(ordinaldf)*length(bindata), ncol = 1)
cont = 1
for (j in 1:length(bindata)){
for (i in 1:length(ordinaldf)){
var1 = ordinaldf[[i]]
var2 = bindata[[j]]
rpb[cont,] = polyserial(as.numeric(ordinaldf[[i]]), as.numeric(bindata[[j]]))
pvalue[cont,] = cor.test(as.numeric(ordinaldf[[i]]),as.numeric(bindata[[j]]))$p.value
xaxis[cont,] = names(ordinaldf[i])
yaxis[cont,] = names(bindata[j])
#Retornar contagem de valores zero e valores um da variável binária
#Isto é importante para saber quantos dados temos na correlação
#As vezes a correlação é grande só porque temos poucos dados
aux = data.frame(bin = bindata[[j]], ord = ordinaldf[[i]])
aux_ = aux[complete.cases(aux),]
tbl = table(aux_[[1]]) #Contar apenas o número de zeros e ones do binário, que é a primeira coluna
cont_Bin_0[cont,] = tbl[1] #Número de zeros
cont_Bin_1[cont,] = tbl[2] #Número de ones
#Ele retorna missing no boxplot se a pessoa respondeu a questão da ordinária, mas N?o respondeu a questão binária
missingord = aux[!is.na(aux[[2]]),] #O ??ndice 2 se refere à variável ordinal
missing[cont,] = sum(is.na(missingord[[1]])) #O ??ndice 1 se refere à variável binária, da qual deveremos contar os missing
cont = cont + 1
}
}
#Aqui finalmente é a matriz de correlação
pbmatrix = data.frame(cbind(yaxis, xaxis, rpb, pvalue, cont_Bin_0, cont_Bin_1, missing))
names(pbmatrix) = c("Binaria","Ordinal","rpb","pvalue","Bin_0","Bin_1","Missing")
write.csv(pbmatrix, 'outputdata/biserial_nopvaluefilter.csv')
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$pvalue < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$pvalue > 0.3, ]
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$pvalue < 0.9999, ]
data_pvalue
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$pvalue < 0.9999, ]
data_pvalue
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$pvalue < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$pvalue > 0.3, ]
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$pvalue < 0.9999, ]
View(data_pvalue)
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$rpb < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$rpb > 0.3, ]
data_pvalue
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$rpb < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$rpb > 0.3, ]
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
#Aqui finalmente é a matriz de correlação
pbmatrix = data.frame(cbind(yaxis, xaxis, rpb, pvalue, cont_Bin_0, cont_Bin_1, missing))
names(pbmatrix) = c("Binaria","Ordinal","rpb","pvalue","Bin_0","Bin_1","Missing")
oldDN4 = c("DN4_1a_v1","DN4_1b_v1","DN4_1c_v1","DN4_2a_v1","DN4_2b_v1","DN4_2c_v1","DN4_2d_v1","DN4_3a_v1","DN4_3b_v1","DN4_4_v1")
newDN4 = c("DN4 - Queimação","DN4 - Sensação de frio dolorosa","DN4 - Choque elétrico","DN4 - Formigamento",
"DN4 - Alfinetada e agulhada","DN4 - Adormecimento","DN4 - Coceira",
"DH4 - Hipoestesia ao toque","DN4 - Hipoestesia a picada de agulha",
"DN4 - Escovação")
oldnames = c("Dor_costas","Analg.e9.sicos","Casado_Amasiado","D30","Dor_pernas","Cirurgia_coluna")
newnames = c("Dor nas costas","Analgésicos","Casado/Amasiaado","Lombalgia","Dor nas pernas","Cirurgia na coluna")
#Substituir
for (i in 1:length(oldDN4)){
pbmatrix$Binaria = sub(oldDN4[i],newDN4[i],pbmatrix$Binaria)
}
for (i in 1:length(newnames)){
pbmatrix$Binaria = sub(oldnames[i],newnames[i],pbmatrix$Binaria)
}
write.csv(pbmatrix, 'outputdata/biserial_nopvaluefilter.csv')
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$rpb < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$rpb > 0.3, ]
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binarina %in% c("Dor nas costas, Dor nas pernas, Lombalgia")
)
#Aqui finalmente é a matriz de correlação
pbmatrix = data.frame(cbind(yaxis, xaxis, rpb, pvalue, cont_Bin_0, cont_Bin_1, missing))
names(pbmatrix) = c("Binaria","Ordinal","rpb","pvalue","Bin_0","Bin_1","Missing")
oldDN4 = c("DN4_1a_v1","DN4_1b_v1","DN4_1c_v1","DN4_2a_v1","DN4_2b_v1","DN4_2c_v1","DN4_2d_v1","DN4_3a_v1","DN4_3b_v1","DN4_4_v1")
newDN4 = c("DN4 - Queimação","DN4 - Sensação de frio dolorosa","DN4 - Choque elétrico","DN4 - Formigamento",
"DN4 - Alfinetada e agulhada","DN4 - Adormecimento","DN4 - Coceira",
"DH4 - Hipoestesia ao toque","DN4 - Hipoestesia a picada de agulha",
"DN4 - Escovação")
oldnames = c("Dor_costas","Analg.e9.sicos","Casado_Amasiado","D30","Dor_pernas","Cirurgia_coluna")
newnames = c("Dor nas costas","Analgésicos","Casado/Amasiaado","Lombalgia","Dor nas pernas","Cirurgia na coluna")
#Substituir
for (i in 1:length(oldDN4)){
pbmatrix$Binaria = sub(oldDN4[i],newDN4[i],pbmatrix$Binaria)
}
for (i in 1:length(newnames)){
pbmatrix$Binaria = sub(oldnames[i],newnames[i],pbmatrix$Binaria)
}
write.csv(pbmatrix, 'outputdata/biserial_nopvaluefilter.csv')
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$rpb < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$rpb > 0.3, ]
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binarina %in% c("Dor nas costas, Dor nas pernas, Lombalgia")
)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binarina %in% c("Dor nas costas", "Dor nas pernas", "Lombalgia")
)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binaria %in% c("Dor nas costas", "Dor nas pernas", "Lombalgia")
)
write.csv(data_, file = 'outputdata/biserial_pvalue_DoresPrincipais.csv', row.names = FALSE)
#Aqui finalmente é a matriz de correlação
pbmatrix = data.frame(cbind(yaxis, xaxis, rpb, pvalue, cont_Bin_0, cont_Bin_1, missing))
names(pbmatrix) = c("Binaria","Ordinal","rpb","pvalue","Bin_0","Bin_1","Missing")
oldDN4 = c("DN4_1a_v1","DN4_1b_v1","DN4_1c_v1","DN4_2a_v1","DN4_2b_v1","DN4_2c_v1","DN4_2d_v1","DN4_3a_v1","DN4_3b_v1","DN4_4_v1")
newDN4 = c("DN4 - Queimação","DN4 - Sensação de frio dolorosa","DN4 - Choque elétrico","DN4 - Formigamento",
"DN4 - Alfinetada e agulhada","DN4 - Adormecimento","DN4 - Coceira",
"DH4 - Hipoestesia ao toque","DN4 - Hipoestesia a picada de agulha",
"DN4 - Escovação")
oldnames = c("Dor_costas","Analg.e9.sicos","Casado_Amasiado","D30","Dor_pernas","Cirurgia_coluna")
newnames = c("Dor nas costas","Analgésicos","Casado/Amasiaado","Lombalgia","Dor nas pernas","Cirurgia na coluna")
#Substituir
for (i in 1:length(oldDN4)){
pbmatrix$Binaria = sub(oldDN4[i],newDN4[i],pbmatrix$Binaria)
}
for (i in 1:length(newnames)){
pbmatrix$Binaria = sub(oldnames[i],newnames[i],pbmatrix$Binaria)
}
write.csv(pbmatrix, 'outputdata/biserial_nopvaluefilter.csv')
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$rpb < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$rpb > 0.5, ]
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binaria %in% c("Dor nas costas", "Dor nas pernas", "Lombalgia")
)
write.csv(data_, file = 'outputdata/biserial_pvalue_DoresPrincipais.csv', row.names = FALSE)
write.csv(data_, file = 'outputdata/biserial_pvalue_DoresPrincipais.csv', row.names = FALSE)
oldord = c("Tempo.com.a.dor.nas.costas","BPI_6_v1","Há.quanto.tempo.em.São.Paulo.se.de.outro.local",
"Quantidade.de.cirurgias.na.coluna","Tempo.com.a.dor.que.irradia.para.as.pernas")
neword = c("Tempo com a dor nas costas","Intensidade da dor no momento","Há quanto tempo em São Paulo se de outro local",
"Quantidade de cirurgias na coluna","Tempo com a dor que irradia para as pernas")
oldord = c("Tempo.com.a.dor.nas.costas","BPI_6_v1","Há.quanto.tempo.em.São.Paulo.se.de.outro.local",
"Quantidade.de.cirurgias.na.coluna","Tempo.com.a.dor.que.irradia.para.as.pernas")
neword = c("Tempo com a dor nas costas","Intensidade da dor no momento","Há quanto tempo em São Paulo se de outro local",
"Quantidade de cirurgias na coluna","Tempo com a dor que irradia para as pernas")
for (i in 1:length(neword)){
pbmatrix$Ordinal = sub(oldord[i],neword[i],pbmatrix$Ordinal)
}
write.csv(pbmatrix, 'outputdata/biserial_nopvaluefilter.csv')
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$rpb < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$rpb > 0.5, ]
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binaria %in% c("Dor nas costas", "Dor nas pernas", "Lombalgia")
)
write.csv(data_, file = 'outputdata/biserial_pvalue_DoresPrincipais.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binaria %in% c("Dor nas costas", "Dor nas pernas", "Lombalgia")
)
write.csv(data_, file = 'outputdata/biserial_pvalue_DoresPrincipais.csv', row.names = FALSE)
# library
library(tidyverse)
setwd('C:/GD/DS/Lefort/RelevanciaEstatistica')
d30 = read.csv('indata/biserial_pvalue_DoresPrincipais.csv', encoding = 'UTF-8')
d30 = read.csv('outputdata/biserial_pvalue_DoresPrincipais.csv', encoding = 'UTF-8')
names(d30)[3] = 'value'
names(d30)[2] = 'individual'
names(d30)[1] = 'Variável'
data = d30
data[c(4:6)] = NULL
data$value = 100*data$value
#Change factor level order
data$Variável = fct_rev(data$Variável)
# Set a number of 'empty bar' to add at the end of each Variável
empty_bar <- 0
to_add <- data.frame( matrix(NA, empty_bar*nlevels(data$Variável), ncol(data)) )
colnames(to_add) <- colnames(data)
to_add$Variável <- rep(levels(data$Variável), each=empty_bar)
data <- rbind(data, to_add)
data <- data %>% arrange(Variável)
data$id <- seq(1, nrow(data))
# Get the name and the y position of each label
label_data <- data
number_of_bar <- nrow(label_data)
angle <- 90 - 360 * (label_data$id-0.5) /number_of_bar     # I substract 0.5 because the letter must have the angle of the center of the bars. Not extreme right(1) or extreme left (0)
label_data$hjust <- ifelse( angle < -90, 1, 0)
label_data$angle <- ifelse(angle < -90, angle+180, angle)
#Criar uma label customizada
label_data$value = round(label_data$value, 2)
label_data$individual = paste(label_data$individual," - (",label_data$value,")",sep = "")
#Para os casos de valores negativos
label_data$position = ifelse(label_data$value>0,label_data$value,0)
# Make the plot
p <- ggplot(data, aes(x=as.factor(id), y=value, fill=Variável)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
geom_bar(stat="identity", alpha = 0.6) +
ylim(-70,102) +
theme_minimal() +
theme(
legend.position = 'bottom',
axis.text.x = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = 0.5, size = 25),
#Tamanho da legenda
legend.title = element_text(size = 30),
legend.text = element_text(size = 26),
axis.text.y = element_blank()
) +
coord_polar() +
geom_text(data=label_data, aes(x=id, y=position-40, label=individual, hjust=hjust),
color="black", fontface="bold",alpha=0.9, size=7, angle= label_data$angle, inherit.aes = FALSE ) +
xlab('') +
ylab('') +
ggtitle("Correlação entre variáveis binárias \n e variáveis ordinais")
tiff('outputdata/imgs/Lombar_Costas_Pernas_Bisserial.tiff', width = 24, height = 22, units ='in', res = 300)
p
dev.off()
library(tidyverse)
#Aqui finalmente é a matriz de correlação
pbmatrix = data.frame(cbind(yaxis, xaxis, rpb, pvalue, cont_Bin_0, cont_Bin_1, missing))
names(pbmatrix) = c("Binaria","Ordinal","rpb","pvalue","Bin_0","Bin_1","Missing")
oldDN4 = c("DN4_1a_v1","DN4_1b_v1","DN4_1c_v1","DN4_2a_v1","DN4_2b_v1","DN4_2c_v1","DN4_2d_v1","DN4_3a_v1","DN4_3b_v1","DN4_4_v1")
newDN4 = c("DN4 - Queimação","DN4 - Sensação de frio dolorosa","DN4 - Choque elétrico","DN4 - Formigamento",
"DN4 - Alfinetada e agulhada","DN4 - Adormecimento","DN4 - Coceira",
"DH4 - Hipoestesia ao toque","DN4 - Hipoestesia a picada de agulha",
"DN4 - Escovação")
oldnames = c("Dor_costas","Analg.e9.sicos","Casado_Amasiado","D30","Dor_pernas","Cirurgia_coluna")
newnames = c("Dor nas costas","Analgésicos","Casado/Amasiaado","Lombalgia","Dor nas pernas","Cirurgia na coluna")
oldord = c("Tempo.com.a.dor.nas.costas","BPI_6_v1","Há.quanto.tempo.em.São.Paulo.se.de.outro.local",
"Quantidade.de.cirurgias.na.coluna","Tempo.com.a.dor.que.irradia.para.as.pernas")
neword = c("Tempo com a dor nas costas","Intensidade da dor no momento","Há quanto tempo em São Paulo se de outro local",
"Quantidade de cirurgias na coluna","Tempo com a dor que irradia para as pernas")
#Substituir
for (i in 1:length(oldDN4)){
pbmatrix$Binaria = sub(oldDN4[i],newDN4[i],pbmatrix$Binaria)
}
for (i in 1:length(newnames)){
pbmatrix$Binaria = sub(oldnames[i],newnames[i],pbmatrix$Binaria)
}
for (i in 1:length(neword)){
pbmatrix$Ordinal = sub(oldord[i],neword[i],pbmatrix$Ordinal)
}
write.csv(pbmatrix, 'outputdata/biserial_nopvaluefilter.csv')
# P-Value Filter ----------------------------------------------------------
data = read.csv('outputdata/biserial_nopvaluefilter.csv')
data[1] = NULL
data_pvalue = data[data$pvalue < 0.05, ]
data_pvalue = subset(data_pvalue, !is.na(data_pvalue$Binaria))
write.csv(data_pvalue, file = 'outputdata/biseral_pvaluefilter.csv', row.names = FALSE)
# Mais filtros ------------------------------------------------------------
data_pvalue = data_pvalue[data_pvalue$rpb < 0.9999, ]
data_pvalue = data_pvalue[data_pvalue$rpb > 0.5, ]
data_pvalue = data_pvalue[data_pvalue$rpb < -0.5, ]
write.csv(data_pvalue, file = 'outputdata/biserial_pvaluefilter_03.csv', row.names = FALSE)
# Selecionando apenas algumas das binarias --------------------------------
library(tidyverse)
data_ = data_pvalue %>% filter(
Binaria %in% c("Dor nas costas", "Dor nas pernas", "Lombalgia")
)
write.csv(data_, file = 'outputdata/biserial_pvalue_DoresPrincipais.csv', row.names = FALSE)
# library
library(tidyverse)
setwd('C:/GD/DS/Lefort/RelevanciaEstatistica')
d30 = read.csv('outputdata/biserial_pvalue_DoresPrincipais.csv', encoding = 'UTF-8')
names(d30)[3] = 'value'
names(d30)[2] = 'individual'
names(d30)[1] = 'Variável'
data = d30
data[c(4:6)] = NULL
data$value = 100*data$value
#Change factor level order
data$Variável = fct_rev(data$Variável)
# Set a number of 'empty bar' to add at the end of each Variável
empty_bar <- 0
to_add <- data.frame( matrix(NA, empty_bar*nlevels(data$Variável), ncol(data)) )
colnames(to_add) <- colnames(data)
to_add$Variável <- rep(levels(data$Variável), each=empty_bar)
data <- rbind(data, to_add)
data <- data %>% arrange(Variável)
data$id <- seq(1, nrow(data))
# Get the name and the y position of each label
label_data <- data
# library
rm(list=ls())
library(tidyverse)
setwd('C:/GD/DS/Lefort/RelevanciaEstatistica')
d30 = read.csv('outputdata/biserial_pvalue_DoresPrincipais.csv', encoding = 'UTF-8')
names(d30)[3] = 'value'
names(d30)[2] = 'individual'
names(d30)[1] = 'Variável'
data = d30
data[c(4:6)] = NULL
data$value = 100*data$value
#Change factor level order
data$Variável = fct_rev(data$Variável)
# Set a number of 'empty bar' to add at the end of each Variável
empty_bar <- 0
to_add <- data.frame( matrix(NA, empty_bar*nlevels(data$Variável), ncol(data)) )
colnames(to_add) <- colnames(data)
to_add$Variável <- rep(levels(data$Variável), each=empty_bar)
data <- rbind(data, to_add)
data <- data %>% arrange(Variável)
data$id <- seq(1, nrow(data))
# Get the name and the y position of each label
label_data <- data
number_of_bar <- nrow(label_data)
angle <- 90 - 360 * (label_data$id-0.5) /number_of_bar     # I substract 0.5 because the letter must have the angle of the center of the bars. Not extreme right(1) or extreme left (0)
label_data$hjust <- ifelse( angle < -90, 1, 0)
label_data$angle <- ifelse(angle < -90, angle+180, angle)
#Criar uma label customizada
label_data$value = round(label_data$value, 2)
label_data$individual = paste(label_data$individual," - (",label_data$value,")",sep = "")
#Para os casos de valores negativos
label_data$position = ifelse(label_data$value>0,label_data$value,0)
# Make the plot
p <- ggplot(data, aes(x=as.factor(id), y=value, fill=Variável)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
geom_bar(stat="identity", alpha = 0.6) +
ylim(-70,102) +
theme_minimal() +
theme(
legend.position = 'bottom',
axis.text.x = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = 0.5, size = 25),
#Tamanho da legenda
legend.title = element_text(size = 30),
legend.text = element_text(size = 26),
axis.text.y = element_blank()
) +
coord_polar() +
geom_text(data=label_data, aes(x=id, y=position-40, label=individual, hjust=hjust),
color="black", fontface="bold",alpha=0.9, size=7, angle= label_data$angle, inherit.aes = FALSE ) +
xlab('') +
ylab('') +
ggtitle("Correlação entre variáveis binárias \n e variáveis ordinais")
tiff('outputdata/imgs/Lombar_Costas_Pernas_Bisserial.tiff', width = 24, height = 22, units ='in', res = 300)
p
dev.off()
# Cirurgia na coluna e estar desempregado ---------------------------------
library(tidyverse)
# Create dataset
data <- data.frame(
individual=paste( "Mister ", seq(1,60), sep=""),
Variável=c( rep('A', 10), rep('B', 30), rep('C', 14), rep('D', 6)) ,
value=sample( seq(10,100), 60, replace=T)
)
setwd('C:/GD/DS/Lefort/PlotsML')
data_sur_job = read.csv('indata/Cirurgia_coluna_Desempregado_Bisserial.csv', encoding = 'UTF-8')
names(data_sur_job)[3] = 'value'
names(data_sur_job)[2] = 'individual'
names(data_sur_job)[1] = 'Variável'
data = data_sur_job
data[c(4:6)] = NULL
data$value = 100*data$value
#Change factor level order
data$Variável = fct_rev(data$Variável)
# Set a number of 'empty bar' to add at the end of each Variável
empty_bar <- 0
to_add <- data.frame( matrix(NA, empty_bar*nlevels(data$Variável), ncol(data)) )
colnames(to_add) <- colnames(data)
to_add$Variável <- rep(levels(data$Variável), each=empty_bar)
data <- rbind(data, to_add)
data <- data %>% arrange(Variável)
data$id <- seq(1, nrow(data))
# Get the name and the y position of each label
label_data <- data
number_of_bar <- nrow(label_data)
angle <- 90 - 360 * (label_data$id-0.5) /number_of_bar     # I substract 0.5 because the letter must have the angle of the center of the bars. Not extreme right(1) or extreme left (0)
label_data$hjust <- ifelse( angle < -90, 1, 0)
label_data$angle <- ifelse(angle < -90, angle+180, angle)
#Criar uma label customizada
label_data$value = round(label_data$value, 2)
label_data$individual = paste(label_data$individual," - (",label_data$value,")",sep = "")
#Para os casos de valores negativos
label_data$position = ifelse(label_data$value>0,label_data$value,0)
# Make the plot
p <- ggplot(data, aes(x=as.factor(id), y=value, fill=Variável)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
geom_bar(stat="identity", alpha = 0.6) +
scale_fill_manual(values = c("#FC4E07","#9400D3")) +
ylim(-70,102) +
theme_minimal() +
theme(
legend.position = 'bottom',
axis.text.x = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = 0.5, size = 25),
#Tamanho da legenda
legend.title = element_text(size = 30),
legend.text = element_text(size = 26),
axis.text.y = element_blank()
) +
coord_polar() +
geom_text(data=label_data, aes(x=id, y=position-10, label=individual, hjust=hjust),
color="black", fontface="bold",alpha=0.9, size=6, angle= label_data$angle, inherit.aes = FALSE ) +
xlab('') +
ylab('') +
ggtitle("Correlação entre variáveis binárias \n e variáveis ordinais")
tiff('outputdata/imgs/Cirurgia_Desempregado_Bisserial.tiff', width = 24, height = 20, units ='in', res = 300)
p
dev.off()
